{% extends 'base.html' %}

{% block head %}
<title>{{title}}</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak={{key}}"></script>
<style>
  html,
  body {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
  }

  #container {
    width: 100%;
    height: 100%;
    margin: 0;
  }

</style>
{% endblock %}

{% block content %}
<div id="container"></div>
<script>
  /* global BMapGL */

  /* global mapv */

  /* global mapvgl */

  /* global initMap */

  /* global whiteStyle */

  var map = new BMap.Map("container", {
    coordsType: 5 // coordsType指定输入输出的坐标类型，3为gcj02坐标，5为bd0ll坐标，默认为5。
    // 指定完成后API将以指定的坐标类型处理您传入的坐标
  });          // 创建地图实例  
  var point = new BMap.Point(121.621314, 38.919658);  // 创建点坐标  
  map.centerAndZoom(point, 15);
  map.enableScrollWheelZoom(true);
  map.addControl(new BMap.NavigationControl());
  map.addControl(new BMap.ScaleControl());
  map.addControl(new BMap.OverviewMapControl());

  {% for loc in locs %}
  var point{{loc[0]}} = new BMap.Point({{loc[1]}}, {{loc[2]}});
  var marker{{loc[0]}} = new BMap.Marker(point{{loc[0]}});
  map.addOverlay(marker{{loc[0]}});
  
  // 创建信息窗口
  marker{{loc[0]}}.addEventListener("click", function(){
    var opts = {    
    width : 250,     // 信息窗口宽度    
    height: 100,     // 信息窗口高度    
    title : '{{loc[3]}}',  // 信息窗口标题   
    }
    var infoWindow = new BMap.InfoWindow(
      "地址: {{loc[4]}}<br>时间: {{loc[5]}}<br>电话: {{loc[6]}}", 
      opts);  // 创建信息窗口对象
    map.openInfoWindow(infoWindow, point{{loc[0]}});
    // console.log("clicked on {{loc[3]}}, {{loc[4]}}");
    // console.log(opts.title);
  });
  {% endfor %}

</script>
{% endblock %}
